# 🎨 Complete Rainmeter Integration Guide

## 🎯 How the System Works

This project creates a **complete desktop task management system** using two components:

1. **TodoistTaskFetcher** (this project) - Fetches tasks from Todoist and saves them to a text file
2. **Rainmeter Skin** (separate, in your Documents folder) - Reads the text file and displays tasks on your desktop

```
Todoist API → TodoistTaskFetcher → tasks.txt → Rainmeter Skin → Desktop Widget
```

## 📁 File Locations

### Your Project (TodoistTaskFetcher)
```
TasksFromTodoist/
├── build/TodoistTaskFetcher.exe    # Fetches tasks from Todoist
├── scripts/todoistRefresh.ps1      # Automation script
└── output/tasks.txt                # Generated task file
```

### Rainmeter Skin (Your Documents Folder)
```
C:\Users\YourName\Documents\Rainmeter\Skins\Todoist\
├── Main/
│   └── Todoist.ini                 # Main skin configuration
├── @Resources/
│   ├── LuaTextFile.lua            # Script to read task file
│   ├── todoistTasks.txt           # Task file (generated by your project)
│   ├── dimensions.txt             # Image dimensions
│   └── Images/
│       ├── blurImage.jpg          # Processed wallpaper
│       └── refresh.png            # Refresh button icon
└── Mail/ (if you have mail skin)
```

## 🔗 How They Connect

### 1. Task Generation
Your TodoistTaskFetcher project:
- Connects to Todoist API
- Fetches your inbox tasks
- Saves them to a text file in this format:
```
TASKS:
1) Complete project documentation
2) Review pull requests
3) Update website
```

### 2. Desktop Display
Your Rainmeter skin:
- Reads the text file using Lua script
- Displays tasks with beautiful formatting
- Shows blurred wallpaper background
- Provides refresh button to update tasks

## ⚙️ Configuration Setup

### Step 1: Configure Your Project
Edit `config\config.local.json` to point to your Rainmeter folder:

```json
{
    "todoist": {
        "api_token": "your_todoist_api_token_here",
        "filter": "#Inbox"
    },
    "paths": {
        "tasks_file": "C:\\Users\\YourName\\Documents\\Rainmeter\\Skins\\Todoist\\@Resources\\todoistTasks.txt",
        "wallpaper_output": "C:\\Users\\YourName\\Documents\\Rainmeter\\Skins\\Todoist\\@Resources\\Images\\blurImage.jpg",
        "dimensions_file": "C:\\Users\\YourName\\Documents\\Rainmeter\\Skins\\Todoist\\@Resources\\dimensions.txt"
    },
    "rainmeter": {
        "enabled": true,
        "executable_path": "C:\\Program Files\\Rainmeter\\Rainmeter.exe"
    }
}
```

**Important**: Replace `YourName` with your actual Windows username!

### Step 2: Verify Rainmeter Skin Location
Make sure your Rainmeter skin is located at:
```
C:\Users\YourName\Documents\Rainmeter\Skins\Todoist\
```

### Step 3: Test the Connection
```powershell
# Run the task fetcher
.\scripts\todoistRefresh.ps1

# Check if the file was created
Get-Content "C:\Users\YourName\Documents\Rainmeter\Skins\Todoist\@Resources\todoistTasks.txt"
```

## 🎮 Usage Workflow

### Daily Usage
1. **Automatic**: Set up Windows Task Scheduler to run `todoistRefresh.ps1` every 30 minutes
2. **Manual**: Click the refresh button in your Rainmeter widget
3. **Command Line**: Run `.\scripts\todoistRefresh.ps1` when you want updates

### What Happens When You Refresh
1. 📥 Fetches latest tasks from Todoist
2. 💾 Saves tasks to `todoistTasks.txt` in Rainmeter folder
3. 🖼️ Processes your current wallpaper (crop and blur)
4. 📐 Saves image dimensions for proper scaling
5. 🔄 Refreshes Rainmeter skin to show new tasks
6. ✨ Your desktop widget updates with latest tasks!

## 🛠️ Rainmeter Skin Details

### Key Components in Your Todoist.ini

**Lua Script Integration**:
```ini
[MeasureLuaScript]
Measure=Script
ScriptFile="#@#LuaTextFile.lua"
TaskFileToRead=#@#todoistTasks.txt    # ← Reads your generated file
DimFileToRead=#@#dimensions.txt
```

**Refresh Button**:
```ini
[MeterRefreshButton]
LeftMouseUpAction=["#desktopTerminalPath#/startup/todoistRefresh.ps1"][!CommandMeasure MeasureLuaScript "RefreshButton()"]
```

**Task Display**:
```ini
[MeterTodoistTasks]
Meter=String
MeasureName=MeasureLuaScript    # ← Gets text from Lua script
FontFace=Segoe UI
FontSize=12
FontColor=255,255,255,255
```

## 🔧 Customization Options

### Change Task Appearance
Edit the `[MeterTodoistTasks]` section in `Todoist.ini`:
- `FontFace` - Change font (e.g., "Arial", "Calibri")
- `FontSize` - Adjust text size
- `FontColor` - Change text color (R,G,B,Alpha)

### Modify Widget Size
Edit the `[Variables]` section:
- `Height` and `Width` - Overall widget dimensions
- Image crop settings for background

### Custom Task Filters
Edit your `config\config.local.json`:
```json
{
    "todoist": {
        "filter": "@work & today"     # Work tasks due today
        "filter": "p1 | overdue"      # Priority 1 or overdue
        "filter": "#Project1"         # Specific project
    }
}
```

## 🔄 Updating Your System

### Update Task Fetcher
```powershell
cd TodoistTaskFetcher
git pull origin main
.\scripts\setup.ps1
```

### Update Rainmeter Skin
Your existing Rainmeter skin will continue working. If you get an updated version:
1. Backup your current `@Resources` folder
2. Replace skin files
3. Copy back your `todoistTasks.txt` and configuration

## 🆘 Troubleshooting

### Tasks Not Appearing in Widget
1. **Check file generation**: Look for `todoistTasks.txt` in your Rainmeter @Resources folder
2. **Verify file content**: Open the file to see if tasks are there
3. **Refresh Rainmeter**: Right-click widget → Refresh skin

### Refresh Button Not Working
1. **Check path in Todoist.ini**: Make sure `desktopTerminalPath` points to your script location
2. **Test script manually**: Run `.\scripts\todoistRefresh.ps1` from command line
3. **Check permissions**: Run Rainmeter as administrator if needed

### Wallpaper Not Processing
1. **Verify ImageMagick**: Make sure it's installed and path is correct in config
2. **Check wallpaper**: Ensure Windows has a wallpaper set
3. **Test manually**: Run script with `-SkipRainmeter` to test wallpaper processing only

## 🎯 Pro Tips

1. **Create desktop shortcut** to your refresh script for quick updates
2. **Use Windows Task Scheduler** for automatic updates every 15-30 minutes  
3. **Backup your Rainmeter @Resources folder** before making changes
4. **Test changes** by running the script manually before setting up automation
5. **Monitor task file size** - very large task lists might need formatting adjustments

## 🎉 You're All Set!

Your complete system:
- ✅ Fetches tasks from Todoist automatically
- ✅ Processes wallpaper for beautiful backgrounds  
- ✅ Displays tasks in a gorgeous desktop widget
- ✅ Updates with a single click or automatically
- ✅ Fully customizable appearance and behavior

Enjoy your productivity-boosting desktop task management system! 🚀
